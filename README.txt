Scripts for CRISPR-linked read sequencing

Technology described in publication xyz [include link]
Alignment files are accessible at NCBI Short Read Archive(SRA) with id: SRP148930

1. Optional barcode filtering before alignment ('filter_bcs_before_align.sh' and 'filter_bc_by_perc.py')
filter_bcs_before_align.sh <percentile>:
<percentile> 	(barcodes with up to this percentile of read will be kept after filtering; REQUIRED)

2. Collecting on-target barcodes and filtering ('get_SV_bcs.py' and 'filter_bcs_after_align.py')
get_SV_bcs.py <bam file> <SV coordinates>:
<bam file>	(bam file generated by Long Ranger; REQUIRED)
<SV coordinates>	(a file that defines the breakpoint interval regions and SV type for each SV event; an example of SV coordinates available in 'resources' as 'sv_coords.txt'; REQUIRED)

filter_bcs_after_align.py:
-bed <bed file>	(bed file of coordinates-single or multiple intervals; REQUIRED) 
-b <bam file>	(bam file generated by longranger; REQUIRED)
-w <window size>	(window size for barcode counting; default: 1000)
-r <region size>	(target region size for calculating on target coverage; default:100000)
-n <minimum read map>	(minimum number of read maps for initial filtering; default: 20) 
-c <target coverage>	(target on-target coverage after filtering barcodes with high read map abundance) 
-bc <barcode file>	(barcode file with SV-specific barcodes) 
-wcov <bin size>	(bin size to compare relative read map abundance of barcodes among similar sized molecules)

3. Scaffold filtering and binning ('scaffold_bin.py')
scaffold_bin.py <assembly> <reference minimap index> <phased basic file> <minimum scaffold size> <maximum N base %>:
<assembly> 	(gzipped assembly fasta file generated by Supernova)
<reference minimap index>	(Minimap2 index for reference genome)
<phased basic file>	(a phased basic file generated by Gemtools)
<minimum scaffold size>	(minimum scaffold size for downstream binning step)
<maximum N base %>	(maximum N base % for downstream binning step)

4. Scaffold plot ('align_plot_scaffold.sh', 'parse_aln_from_bam.py', and 'plot_scaffold.R')
align_plot_scaffold.sh:
-f <fastq location>	(the directory containing fastq files; REQUIRED)
-a <assembly>	(the assembly fasta file from Supernova; REQUIRED)
-c <scaffold ID>	(scaffold ID to be plotted; REQUIRED)
-r <read1 fastq>	(read1 fastq file; REQUIRED)
-s <read2 fastq>	(read2 fastq file; REQUIRED)
-g <reference genome>	(the reference genome to be compared; REQUIRED)
-l <target bed>		(target bed for y-axis range; REQUIRED)
-q <minimum map quality>	(minimum map quality for plot; default: 1)

